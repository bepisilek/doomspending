@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

:root{
  --blue-500:#356dff;
  --blue-600:#2b5bf7;
  --blue-700:#1c45d9;
  --cyan:#37d4ff;
  --teal:#28d3c0;
  --green:#31d69f;
  --red:#ff5c6a;
  --orange:#ff9c4a;
  --purple:#b968ff;
  --text:#0f172a;
  --text-secondary:#475569;
  --muted:#5d6b85;
  --white:#ffffff;
  --bg-primary:#f9fbff;
  --bg-secondary:#eef3ff;
  --glass:rgba(255,255,255,0.78);
  --glass-strong:rgba(255,255,255,0.92);
  --glass-border:rgba(255,255,255,0.55);
  --shadow-soft:0 25px 60px -35px rgba(15,27,60,0.65);
  --shadow-hero:0 40px 80px -40px rgba(33,88,255,0.55);
  --shadow-nav:0 26px 60px -30px rgba(18,36,78,0.50);
  --radius-2xl:34px;
  --radius-xl:28px;
  --radius-lg:22px;
  --radius-md:18px;
  --radius-sm:14px;
  --fast:.25s cubic-bezier(.3,.7,.4,1);
  --slow:.6s cubic-bezier(.16,1,.3,1);
}

/* ============================================
   DARK MODE - JAVÍTOTT VERZIÓ
   ============================================ */
[data-theme="dark"]{
  --text:#f1f5f9;
  --text-secondary:#cbd5e1;
  --muted:#94a3b8;
  --bg-primary:#0f172a;
  --bg-secondary:#1e293b;
  --glass:rgba(30,41,59,0.85);
  --glass-strong:rgba(30,41,59,0.95);
  --glass-border:rgba(71,85,105,0.4);
  --shadow-soft:0 25px 60px -35px rgba(0,0,0,0.6);
  --shadow-hero:0 40px 80px -40px rgba(53,109,255,0.4);
  --shadow-nav:0 26px 60px -30px rgba(0,0,0,0.5);
}

[data-theme="dark"] body {
  background:
    radial-gradient(1100px 800px at 80% -10%, rgba(53,109,255,0.15), transparent 60%),
    radial-gradient(900px 900px at -10% 110%, rgba(40,211,192,0.12), transparent 60%),
    linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
}

[data-theme="dark"] body::before {
  background:radial-gradient(circle at center, rgba(53,109,255,0.25), transparent);
}

[data-theme="dark"] body::after {
  background:radial-gradient(circle at center, rgba(40,211,192,0.2), transparent);
}

[data-theme="dark"] .welcome-pill {
  background:rgba(30,41,59,0.8);
  border-color:rgba(71,85,105,0.5);
  color:var(--text-secondary);
}

[data-theme="dark"] .card {
  background:var(--glass);
  border-color:var(--glass-border);
}

[data-theme="dark"] input,
[data-theme="dark"] select {
  background:rgba(15,23,42,0.7);
  border-color:rgba(71,85,105,0.5);
  color:var(--text);
}

[data-theme="dark"] input::placeholder {
  color:var(--muted);
}

[data-theme="dark"] .screen-header {
  background:var(--glass);
  border-color:var(--glass-border);
}

[data-theme="dark"] .theme-toggle {
  background:rgba(30,41,59,0.8);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] .theme-toggle svg {
  fill:#60a5fa;
}

[data-theme="dark"] .hero-clock {
  background:
    radial-gradient(circle at 50% 38%, rgba(30,41,59,0.95) 0%, rgba(30,41,59,0.8) 35%, rgba(15,23,42,0.6) 60%, rgba(53,109,255,0.2) 100%);
  box-shadow:
    0 22px 60px -32px rgba(53,109,255,0.4),
    inset 0 14px 36px rgba(71,85,105,0.5),
    inset 0 -12px 28px rgba(53,109,255,0.15);
}

[data-theme="dark"] .hero-clock::before {
  background:
    radial-gradient(circle at 50% 50%, rgba(30,41,59,1) 0%, rgba(30,41,59,0.8) 60%, rgba(15,23,42,0.8) 62%, rgba(15,23,42,0.5) 65%, transparent 70%);
  box-shadow:
    inset 0 0 0 1px rgba(71,85,105,0.5),
    inset 0 6px 18px rgba(71,85,105,0.3),
    0 24px 54px -34px rgba(53,109,255,0.3);
}

[data-theme="dark"] .clock-body {
  background:
    radial-gradient(circle at 50% 45%, rgba(30,41,59,0.95) 0%, rgba(15,23,42,0.85) 50%, rgba(15,23,42,0.7) 80%, rgba(15,23,42,0.6) 100%);
  box-shadow:
    inset 0 0 0 1px rgba(71,85,105,0.4),
    inset 0 20px 50px rgba(0,0,0,0.3);
}

[data-theme="dark"] .clock-bell,
[data-theme="dark"] .clock-leg {
  background:linear-gradient(180deg, rgba(30,41,59,0.95), rgba(15,23,42,0.9));
}

[data-theme="dark"] .result-box {
  background:linear-gradient(160deg, rgba(53,109,255,0.25) 0%, rgba(30,41,59,0.85) 100%);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] .comparison {
  background:rgba(15,23,42,0.7);
  color:var(--text-secondary);
}

[data-theme="dark"] .history-item {
  background:var(--glass);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] .history-item.saved {
  background:rgba(49,214,159,0.15);
  border-left-color:#31d69f;
}

[data-theme="dark"] .history-item.spent {
  background:rgba(255,92,106,0.15);
  border-left-color:#ff5c6a;
}

[data-theme="dark"] .achievement {
  background:var(--glass);
  border-color:var(--glass-border);
}

[data-theme="dark"] .achievement.unlocked {
  background:linear-gradient(135deg, rgba(49,214,159,0.2), rgba(30,41,59,0.8));
  border-color:rgba(49,214,159,0.4);
}

[data-theme="dark"] .progress-shell {
  background:var(--glass);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] .progress-ring {
  background:
    radial-gradient(circle at center, rgba(30,41,59,0.95) 0%, rgba(30,41,59,0.3) 58%, transparent 65%),
    conic-gradient(from -90deg, #2b5bf7 var(--progress), rgba(71,85,105,0.4) var(--progress));
  box-shadow:0 30px 70px -40px rgba(53,109,255,0.4);
}

[data-theme="dark"] .progress-ring::after {
  background:rgba(15,23,42,0.95);
}

[data-theme="dark"] .stats-card {
  background:var(--glass-strong);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] .quote-card {
  background:linear-gradient(135deg, rgba(185,104,255,0.2), rgba(30,41,59,0.85));
  border-color:rgba(185,104,255,0.3);
}

[data-theme="dark"] nav {
  background:rgba(15,23,42,0.85);
  border-color:rgba(71,85,105,0.5);
}

[data-theme="dark"] nav button {
  color:var(--text-secondary);
}

[data-theme="dark"] nav button.active {
  background:linear-gradient(135deg, rgba(42,104,255,0.95), rgba(55,212,255,0.8));
  color:#fff;
}

[data-theme="dark"] .invite-card {
  background:var(--glass-strong);
  border-color:var(--glass-border);
}

[data-theme="dark"] .invite-copy {
  color:var(--text-secondary);
}

/* ============================================
   ALAPÉRTELMEZETT LIGHT MODE STÍLUSOK
   ============================================ */

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;}
body{
  font-family:Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  color:var(--text);
  background:
    radial-gradient(1200px 600px at 80% -10%, rgba(120,216,255,0.25), rgba(255,255,255,0) 60%),
    radial-gradient(900px 900px at -10% 110%, rgba(53,109,255,0.20), rgba(255,255,255,0) 60%),
    linear-gradient(180deg,#eef3ff 0%, #f9fbff 100%);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:stretch;
  overflow-x:hidden;
  position:relative;
  transition:background 0.4s ease, color 0.3s ease;
}

body::before, body::after{
  content:"";
  position:fixed;
  pointer-events:none;
  filter:blur(120px);
  opacity:0.65;
  z-index:0;
  transition:opacity 0.4s ease;
}
body::before{
  width:540px; height:540px; top:-180px; right:-130px;
  background:radial-gradient(circle at center, rgba(81,167,255,0.6), rgba(255,255,255,0));
}
body::after{
  width:560px; height:560px; bottom:-220px; left:-160px;
  background:radial-gradient(circle at center, rgba(143,219,255,0.55), rgba(255,255,255,0));
}

.app-shell{
  width:min(100%,480px);
  min-height:100vh;
  padding:clamp(24px,6vw,44px) clamp(18px,6vw,32px) 280px;
  position:relative;
  z-index:1;
  display:flex;
}
.screen-stack{flex:1; display:flex; position:relative;}
.screen{
  display:none;
  width:100%;
  position:relative;
  animation:fadeSlide var(--slow);
}
.screen.active{display:block;}

@keyframes fadeSlide{
  from{opacity:0; transform:translateY(18px);}
  to{opacity:1; transform:translateY(0);}
}

.screen::before{
  content:"";
  position:absolute; inset:0; z-index:-1;
  border-radius:var(--radius-2xl);
  background:radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.15) 65%, rgba(255,255,255,0) 100%);
  opacity:0.75;
  pointer-events:none;
}

h1{font-size:clamp(2.2rem,8vw,2.7rem); font-weight:800; letter-spacing:-.01em; text-align:center;}
h2{font-size:1.5rem; font-weight:700;}
h3{font-size:1.15rem; font-weight:700; margin-bottom:12px;}
p{color:var(--muted); line-height:1.6;}
.caption{font-size:.72rem; text-transform:uppercase; letter-spacing:.18em; color:var(--muted);}

.hidden{
  display:none !important;
}

/* Update Banner (PWA) */
.update-banner{
  position:fixed;
  top:0;
  left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg, #ff9c4a 0%, #ff5c6a 100%);
  color:#fff;
  padding:12px 20px;
  border-radius:0 0 16px 16px;
  box-shadow:0 8px 24px rgba(255,92,106,0.4);
  z-index:100;
  display:flex;
  align-items:center;
  gap:12px;
  font-size:0.9rem;
  font-weight:600;
  animation:slideDown 0.4s ease;
}
.update-btn{
  padding:6px 16px !important;
  font-size:0.85rem !important;
  background:rgba(255,255,255,0.25) !important;
  border:1px solid rgba(255,255,255,0.4) !important;
  color:#fff !important;
  border-radius:8px !important;
  cursor:pointer;
  transition:all var(--fast);
  font-weight:700 !important;
  width:auto !important;
}
.update-btn:hover{
  background:rgba(255,255,255,0.35) !important;
  transform:scale(1.05);
}

/* Version Banner */
.version-banner{
  position:fixed;
  top:0;
  left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg, #31d69f 0%, #28d3c0 100%);
  color:#fff;
  padding:12px 20px;
  border-radius:0 0 16px 16px;
  box-shadow:0 8px 24px rgba(49,214,159,0.4);
  z-index:100;
  display:flex;
  align-items:center;
  gap:12px;
  font-size:0.9rem;
  font-weight:600;
  animation:slideDown 0.4s ease;
}
@keyframes slideDown{
  from{ transform:translateX(-50%) translateY(-100%); opacity:0; }
  to{ transform:translateX(-50%) translateY(0); opacity:1; }
}
.version-btn{
  padding:6px 16px !important;
  font-size:0.85rem !important;
  background:rgba(255,255,255,0.25) !important;
  border:1px solid rgba(255,255,255,0.4) !important;
  color:#fff !important;
  border-radius:8px !important;
  cursor:pointer;
  transition:all var(--fast);
  font-weight:700 !important;
  width:auto !important;
}
.version-btn:hover{
  background:rgba(255,255,255,0.35) !important;
  transform:scale(1.05);
}

.screen-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:18px 22px; margin-bottom:18px;
  border-radius:var(--radius-xl);
  background:var(--glass);
  backdrop-filter:blur(24px);
  border:1px solid var(--glass-border);
  box-shadow:var(--shadow-soft);
  position:relative;
}
.header-icon{
  width:46px; height:46px; border-radius:18px;
  background:linear-gradient(135deg, rgba(49,115,255,0.92), rgba(120,216,255,0.65));
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 16px 32px -18px rgba(26,92,255,0.7);
}
.header-icon svg{width:22px; height:22px; fill:#fff;}

.theme-toggle{
  position:absolute;
  top:50%;
  right:80px;
  transform:translateY(-50%);
  width:44px;
  height:44px;
  border-radius:12px;
  background:rgba(255,255,255,0.5);
  border:1px solid rgba(200,215,255,0.5);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all var(--fast);
}
.theme-toggle:hover{
  transform:translateY(-50%) scale(1.05);
  background:rgba(255,255,255,0.75);
}
.theme-toggle svg{
  width:20px;
  height:20px;
  fill:var(--blue-600);
  transition:fill 0.3s ease;
}

.welcome-hero{
  margin-top:24px;
  display:flex; flex-direction:column; align-items:center; gap:26px;
  text-align:center;
}
.welcome-pill{
  padding:10px 18px; border-radius:999px;
  background:rgba(255,255,255,0.65); border:1px solid rgba(255,255,255,0.6);
  color:var(--muted); font-size:.82rem;
  backdrop-filter:blur(20px);
  box-shadow:0 10px 28px -22px rgba(15,27,60,0.8);
  transition:all 0.3s ease;
}
.welcome-copy{max-width:340px; font-size:1rem;}

.hero-clock{
  width:220px; height:220px; position:relative; border-radius:50%;
  display:grid; place-items:center;
  background:
    radial-gradient(circle at 50% 38%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.8) 35%, rgba(245,250,255,0.55) 60%, rgba(35,123,255,0.20) 100%);
  box-shadow:
    0 22px 60px -32px rgba(25,78,255,0.55),
    inset 0 14px 36px rgba(255,255,255,0.9),
    inset 0 -12px 28px rgba(120,180,255,0.25);
  overflow:visible;
  animation:floatClock 5s ease-in-out infinite;
  isolation:isolate;
  transition:all 0.4s ease;
}
.hero-clock::before{
  content:"";
  position:absolute; inset:10px; border-radius:50%;
  background:
    radial-gradient(circle at 50% 50%, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 60%, rgba(240,246,255,0.8) 62%, rgba(230,238,255,0.45) 65%, rgba(255,255,255,0) 70%);
  box-shadow:
    inset 0 0 0 1px rgba(180,205,255,0.55),
    inset 0 6px 18px rgba(255,255,255,0.9),
    0 24px 54px -34px rgba(40,88,210,0.55);
  pointer-events:none;
  transition:all 0.4s ease;
}
.hero-clock::after{
  content:"";
  position:absolute; width:70%; height:16px; bottom:-20px; left:15%;
  background:radial-gradient(ellipse at center, rgba(30,50,105,0.28), rgba(30,50,105,0) 70%);
  filter:blur(10px);
  opacity:.65;
  z-index:-1;
}

.clock-body{
  position:relative; width:72%; height:72%; border-radius:50%;
  background:
    radial-gradient(circle at 50% 45%, rgba(255,255,255,0.95) 0%, rgba(245,250,255,0.85) 50%, rgba(200,220,255,0.60) 80%, rgba(180,210,255,0.45) 100%);
  box-shadow:
    inset 0 0 0 1px rgba(210,222,255,0.55),
    inset 0 20px 50px rgba(255,255,255,0.9);
  display:grid; place-items:center;
  transition:all 0.4s ease;
}

.clock-body::before{
  content:"";
  position:absolute; inset:10%; border-radius:50%;
  background:
    conic-gradient(from -90deg,
      rgba(103,140,225,0.35) 0.5deg, transparent 1deg,
      transparent 29deg, rgba(103,140,225,0.35) 30deg,
      transparent 31deg, transparent 59deg, rgba(103,140,225,0.35) 60deg,
      transparent 61deg, transparent 89deg, rgba(103,140,225,0.35) 90deg,
      transparent 91deg, transparent 119deg, rgba(103,140,225,0.35) 120deg,
      transparent 121deg, transparent 149deg, rgba(103,140,225,0.35) 150deg,
      transparent 151deg, transparent 179deg, rgba(103,140,225,0.35) 180deg,
      transparent 181deg, transparent 209deg, rgba(103,140,225,0.35) 210deg,
      transparent 211deg, transparent 239deg, rgba(103,140,225,0.35) 240deg,
      transparent 241deg, transparent 269deg, rgba(103,140,225,0.35) 270deg,
      transparent 271deg, transparent 299deg, rgba(103,140,225,0.35) 300deg,
      transparent 301deg, transparent 329deg, rgba(103,140,225,0.35) 330deg,
      transparent 331deg
    );
  filter:blur(.2px);
}

.clock-hand{
  position:absolute; bottom:50%; left:50%;
  transform-origin:bottom center;
  background:linear-gradient(180deg, rgba(53,109,255,0.9), rgba(120,216,255,0.9));
  border-radius:999px;
  box-shadow:0 6px 16px -8px rgba(33,88,255,0.65);
}
.clock-hand.hour{ width:6px; height:34%; transform:translate(-50%, 0) rotate(0deg); animation:tickHour 720s linear infinite; }
.clock-hand.minute{ width:4px; height:46%; transform:translate(-50%, 0) rotate(0deg); animation:tickMinute 60s linear infinite; }

.clock-bell{
  position:absolute; top:-22px; width:54px; height:28px; border-radius:999px 999px 16px 16px/999px 999px 16px 16px;
  background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(205,220,255,0.9));
  box-shadow:
    0 10px 20px -12px rgba(25,70,180,0.55),
    inset 0 4px 10px rgba(255,255,255,0.9);
  transition:all 0.4s ease;
}
.clock-bell.left{ left:28px; transform:rotate(-8deg); }
.clock-bell.right{ right:28px; transform:rotate(8deg); }

.clock-leg{
  position:absolute; bottom:-6px; width:20px; height:8px; border-radius:12px;
  background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(210,225,255,0.9));
  box-shadow:0 8px 18px -10px rgba(25,60,140,0.5);
  transition:all 0.4s ease;
}
.clock-leg.left{ left:46px; transform:rotate(-8deg); }
.clock-leg.right{ right:46px; transform:rotate(8deg); }

@keyframes floatClock{
  0%,100%{ transform:translateY(0) }
  50%{ transform:translateY(-12px) }
}
@keyframes tickMinute{ from{ transform:translate(-50%, 0) rotate(0deg); } to{ transform:translate(-50%, 0) rotate(360deg); } }
@keyframes tickHour{ from{ transform:translate(-50%, 0) rotate(0deg); } to{ transform:translate(-50%, 0) rotate(360deg); } }

.card{
  background:var(--glass-strong);
  backdrop-filter:blur(26px);
  border-radius:var(--radius-xl);
  border:1px solid var(--glass-border);
  box-shadow:var(--shadow-soft);
  padding:24px;
  transition:all 0.3s ease;
}
.stack{display:flex; flex-direction:column; gap:18px;}
.screen .stack{ padding-bottom:140px; }

.invite-card{ display:flex; flex-direction:column; gap:16px; align-items:stretch; text-align:left; }
.invite-card h3{ text-align:left; margin-bottom:4px; }
.invite-copy{ font-size:0.9rem; color:var(--muted); text-align:left; }
.invite-form{ display:flex; flex-direction:column; gap:12px; }
.invite-form button{ width:100%; }
@media(min-width:520px){
  .invite-form{ flex-direction:row; align-items:center; }
  .invite-form input{ flex:1; }
  .invite-form button{ width:auto; padding-inline:28px; }
}
.invite-status{ min-height:1.4em; font-size:0.88rem; font-weight:600; color:var(--muted); }
.invite-status[data-status="success"]{ color:var(--green); }
.invite-status[data-status="error"]{ color:var(--red); }
.invite-status[data-status="info"]{ color:var(--blue-600); }

input, select{
  width:100%;
  border-radius:var(--radius-md);
  border:1px solid rgba(202,213,255,0.45);
  padding:14px 18px;
  background:rgba(255,255,255,0.55);
  backdrop-filter:blur(10px);
  font-size:1rem; font-weight:500; color:var(--text);
  transition:border var(--fast), box-shadow var(--fast), transform var(--fast), background 0.3s ease;
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.8);
  font-family:inherit;
}
input::placeholder{color:rgba(109,125,150,0.7); font-weight:400;}
input:focus, select:focus{ 
  outline:none; 
  border-color:rgba(50,120,255,0.8); 
  box-shadow:0 0 0 4px rgba(68,143,255,0.18); 
  transform:translateY(-1px); 
}

button{
  position:relative; width:100%; border:none; border-radius:var(--radius-md);
  padding:16px 18px; font-size:1.03rem; font-weight:700; letter-spacing:.01em; color:#fff; cursor:pointer;
  background:linear-gradient(135deg, #2967ff 0%, #25cfff 100%);
  box-shadow:0 28px 60px -32px rgba(19,95,255,0.95);
  transition:transform var(--fast), box-shadow var(--fast);
  overflow:hidden;
  font-family:inherit;
}
button::after{
  content:""; position:absolute; inset:0;
  background:linear-gradient(120deg, rgba(255,255,255,0.35), rgba(255,255,255,0));
  opacity:0; transition:opacity var(--fast);
}
button:hover{ transform:translateY(-2px) scale(1.01); }
button:hover::after{ opacity:1; }
button:active{ transform:scale(0.98); }
.btn-secondary{
  background:rgba(255,255,255,0.9);
  color:var(--blue-600);
  border:1px solid rgba(160,185,255,0.55);
  box-shadow:none;
}

.result-box{
  display:none;
  border-radius:var(--radius-xl);
  padding:28px 22px 32px;
  text-align:center;
  background:linear-gradient(160deg, rgba(38,107,255,0.22) 0%, rgba(255,255,255,0.78) 100%);
  border:1px solid rgba(120,174,255,0.4);
  box-shadow:0 28px 58px -34px rgba(32,83,255,0.65);
  animation:scaleUp var(--slow);
  margin-bottom:120px;
  transition:all 0.3s ease;
}
@keyframes scaleUp{ from{opacity:0; transform:translateY(16px) scale(0.98);} to{opacity:1; transform:translateY(0) scale(1);} }
.result-box .hours{ font-size:3.2rem; font-weight:800; color:var(--blue-600); margin-bottom:8px; }
.comparison{
  margin-top:16px;
  padding:14px;
  background:rgba(255,255,255,0.6);
  border-radius:var(--radius-sm);
  font-size:0.9rem;
  color:var(--muted);
  transition:all 0.3s ease;
}

.decision-buttons{ display:flex; gap:12px; margin-top:20px; }
.decision-buttons button{ flex:1; box-shadow:none; }
.decision-buttons .save{ background:linear-gradient(135deg, #1fb981 0%, #36e1a9 100%); }
.decision-buttons .buy{ background:linear-gradient(135deg, #ff5c6a 0%, #ff7f9a 100%); }

#history-list {
  display:flex;
  flex-direction:column;
  gap:16px;
}

.history-item {
  position:relative;
  padding:20px 22px 22px 26px;
  border-radius:var(--radius-md);
  background:var(--glass);
  backdrop-filter:blur(24px);
  border:1px solid rgba(210,222,255,0.45);
  box-shadow:0 16px 40px -32px rgba(30,50,105,0.5);
  transition:transform var(--fast), box-shadow var(--fast), background 0.3s ease;
  animation:cardEnter .45s ease both;
  overflow:hidden;
}

.history-item.saved {
  background:rgba(49,214,159,0.1);
  border-left:6px solid #34c759;
}

.history-item.spent {
  background:rgba(255,92,106,0.1);
  border-left:6px solid #ff3b30;
}

.history-icon {
  font-size:26px;
  margin-right:10px;
}

.history-item strong {
  display:block;
  font-weight:700;
  margin-bottom:4px;
  color:var(--text);
}

.history-item span {
  font-weight:600;
  color:var(--text);
}

.history-item small {
  color:var(--muted);
  font-size:.78rem;
  display:block;
  margin-top:6px;
}

.history-item:hover {
  transform:translateY(-4px);
  box-shadow:0 26px 60px -34px rgba(30,54,126,0.66);
}

@keyframes cardEnter {
  from { opacity:0; transform:translateY(18px); }
  to   { opacity:1; transform:translateY(0); }
}

.achievements-grid{
  display:grid;
  grid-template-columns:repeat(2, 1fr);
  gap:12px;
}
.achievement{
  padding:18px;
  border-radius:var(--radius-md);
  background:var(--glass);
  border:1px solid var(--glass-border);
  text-align:center;
  transition:all var(--fast);
}
.achievement.unlocked{
  background:linear-gradient(135deg, rgba(49,214,159,0.15), rgba(255,255,255,0.75));
  border-color:rgba(49,214,159,0.4);
}
.achievement.locked{
  opacity:0.5;
  filter:grayscale(1);
}
.achievement-icon{
  font-size:32px;
  margin-bottom:8px;
}
.achievement-title{
  font-size:0.85rem;
  font-weight:700;
  margin-bottom:4px;
  color:var(--text);
}
.achievement-desc{
  font-size:0.72rem;
  color:var(--muted);
}

.stats-grid{ display:flex; flex-direction:column; gap:20px;}
.progress-shell{
  display:flex; flex-direction:column; align-items:center; gap:16px;
  padding:28px 24px 32px; border-radius:var(--radius-xl);
  background:var(--glass); border:1px solid rgba(210,222,255,0.45);
  box-shadow:var(--shadow-soft); backdrop-filter:blur(28px);
  transition:all 0.3s ease;
}
.progress-ring{
  --progress:0deg;
  width:168px; height:168px; border-radius:50%; position:relative;
  background:
    radial-gradient(circle at center, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.2) 58%, rgba(255,255,255,0) 65%),
    conic-gradient(from -90deg, #2b5bf7 var(--progress), rgba(235,242,255,0.6) var(--progress));
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 30px 70px -40px rgba(24,85,255,0.5);
  transition:background .6s ease;
}
.progress-ring::after{
  content:""; position:absolute; inset:12px; border-radius:50%; background:rgba(255,255,255,0.88); backdrop-filter:blur(16px);
  transition:background 0.3s ease;
}
#ratio{ position:relative; font-size:2.4rem; font-weight:800; color:var(--blue-600); z-index:1; }
.pulse{ animation:pulseText .8s ease; }
@keyframes pulseText{ 0%{transform:scale(.92); opacity:.3;} 60%{transform:scale(1.05); opacity:1;} 100%{transform:scale(1);} }

.stats-cards{ display:flex; flex-direction:column; gap:16px; }
.stats-card{
  border-radius:var(--radius-lg); padding:20px 22px;
  background:var(--glass-strong); border:1px solid rgba(210,222,255,0.45);
  box-shadow:0 18px 50px -34px rgba(30,60,120,0.6); backdrop-filter:blur(20px);
  transition:all 0.3s ease;
}
.stats-card strong{ font-size:1.6rem; color:var(--text); }
.stats-card p{ color:var(--text-secondary); }

.chart-container{
  height:180px;
  position:relative;
  margin-top:12px;
}
.chart-bars{
  display:flex;
  align-items:flex-end;
  justify-content:space-around;
  height:100%;
  gap:8px;
}
.chart-bar{
  flex:1;
  background:linear-gradient(180deg, var(--blue-500), var(--cyan));
  border-radius:8px 8px 0 0;
  position:relative;
  min-height:20px;
  transition:all var(--fast);
}
.chart-bar:hover{
  opacity:0.8;
  transform:translateY(-4px);
}
.chart-label{
  position:absolute;
  bottom:-24px;
  left:50%;
  transform:translateX(-50%);
  font-size:0.7rem;
  color:var(--muted);
  white-space:nowrap;
}

.quote-card{
  padding:24px;
  border-radius:var(--radius-xl);
  background:linear-gradient(135deg, rgba(185,104,255,0.15), rgba(255,255,255,0.85));
  border:1px solid rgba(185,104,255,0.3);
  text-align:center;
  margin-bottom:20px;
  transition:all 0.3s ease;
}
.quote-icon{
  font-size:36px;
  margin-bottom:12px;
}
.quote-text{
  font-size:1.05rem;
  font-weight:600;
  color:var(--text);
  font-style:italic;
}

nav{
  position:fixed; left:50%; bottom:36px; transform:translateX(-50%);
  width:min(100%,420px); padding:10px; border-radius:999px;
  background:rgba(255,255,255,0.30); backdrop-filter:blur(28px);
  border:1px solid rgba(255,255,255,0.6); box-shadow:var(--shadow-nav);
  display:none;
  gap:10px; z-index:20;
  pointer-events:none;
  transition:opacity var(--fast), transform var(--fast), background 0.3s ease;
}
nav.show{
  display:flex;
}
nav button{
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px;
  padding:12px; border-radius:18px; background:transparent; color:var(--muted);
  font-size:.74rem; font-weight:700; letter-spacing:.01em; transition:background var(--fast), color var(--fast), transform var(--fast);
  border:none;
  pointer-events:auto;
  box-shadow:none;
}
nav button svg{ width:22px; height:22px; fill:currentColor; transition:transform var(--fast); }
nav button span{ font-size:.72rem; }
nav button:hover{ transform:translateY(-2px); }
nav button:hover svg{ transform:translateY(-1px); }
nav button.active{
  background:linear-gradient(135deg, rgba(42,104,255,0.92), rgba(55,212,255,0.78));
  color:#fff; box-shadow:0 18px 45px -28px rgba(19,95,255,0.9);
}
nav button.active svg{ fill:#fff; }
.nav-glow{
  position:absolute; inset:-18px -30px; border-radius:inherit;
  background:radial-gradient(circle at center, rgba(48,130,255,0.2), rgba(48,130,255,0));
  opacity:0; transition:opacity var(--fast); z-index:-1;
}
nav button.active .nav-glow{ opacity:1; }

.share-widget{
  position:fixed;
  bottom:120px;
  right:20px;
  z-index:90;
  animation:slideInBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  display:none;
}
.share-widget.show{
  display:block;
}
@keyframes slideInBounce{
  from{ opacity:0; transform:translateY(100px) scale(0.8); }
  to{ opacity:1; transform:translateY(0) scale(1); }
}
.share-bubble{
  position:relative;
  background:linear-gradient(135deg, #31d69f 0%, #28d3c0 100%);
  color:#fff;
  padding:18px 22px;
  border-radius:20px 20px 20px 4px;
  box-shadow:0 12px 40px rgba(40,211,192,0.45);
  max-width:280px;
  cursor:pointer;
  transition:all var(--fast);
}
.share-bubble:hover{
  transform:translateY(-3px);
  box-shadow:0 16px 50px rgba(40,211,192,0.6);
}
.share-bubble:active{
  transform:scale(0.98);
}
.share-close{
  position:absolute;
  top:-8px;
  right:-8px;
  width:24px;
  height:24px;
  border-radius:50%;
  background:rgba(255,255,255,0.95);
  color:#31d69f;
  border:none;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-size:16px;
  font-weight:700;
  line-height:1;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
  transition:all var(--fast);
  padding:0;
}
.share-close:hover{
  transform:scale(1.1) rotate(90deg);
  background:#fff;
}
.share-icon{
  font-size:28px;
  margin-bottom:8px;
  animation:wave 1s ease-in-out infinite;
}
@keyframes wave{
  0%, 100%{ transform:rotate(0deg); }
  25%{ transform:rotate(15deg); }
  75%{ transform:rotate(-15deg); }
}
.share-text{
  font-size:0.95rem;
  font-weight:600;
  line-height:1.4;
}
.share-text small{
  display:block;
  margin-top:6px;
  font-size:0.8rem;
  opacity:0.9;
  font-weight:500;
}

@media(min-width:520px){ 
  nav{ bottom:46px; }
  .app-shell{ padding-bottom:300px; }
}
@media(max-width:520px){
  .share-widget{
    bottom:100px;
    right:16px;
  }
  .share-bubble{
    max-width:240px;
    padding:16px 18px;
  }
}
