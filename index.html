<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Munkaóra • vNEXT</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-G8BZPSFGGG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-G8BZPSFGGG');
  </script>

  <style>
    /* =========================================================================
       FONTS
       ========================================================================= */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

    /* =========================================================================
       TOKENS
       ========================================================================= */
    :root{
      --blue-500:#356dff;
      --blue-600:#2b5bf7;
      --blue-700:#1c45d9;
      --cyan:#37d4ff;
      --teal:#28d3c0;
      --green:#31d69f;
      --red:#ff5c6a;
      --text:#0f172a;
      --muted:#5d6b85;
      --white:#ffffff;
      --glass:rgba(255,255,255,0.78);
      --glass-strong:rgba(255,255,255,0.92);
      --glass-border:rgba(255,255,255,0.55);
      --shadow-soft:0 25px 60px -35px rgba(15,27,60,0.65);
      --shadow-hero:0 40px 80px -40px rgba(33,88,255,0.55);
      --shadow-nav:0 26px 60px -30px rgba(18,36,78,0.50);
      --radius-2xl:34px;
      --radius-xl:28px;
      --radius-lg:22px;
      --radius-md:18px;
      --radius-sm:14px;
      --fast:.25s cubic-bezier(.3,.7,.4,1);
      --slow:.6s cubic-bezier(.16,1,.3,1);
    }

    /* =========================================================================
       BASE
       ========================================================================= */
    *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
    html,body{height:100%;}
    body{
      font-family:Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 80% -10%, rgba(120,216,255,0.25), rgba(255,255,255,0) 60%),
        radial-gradient(900px 900px at -10% 110%, rgba(53,109,255,0.20), rgba(255,255,255,0) 60%),
        linear-gradient(180deg,#eef3ff 0%, #f9fbff 100%);
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:stretch;
      overflow-x:hidden;
      position:relative;
    }

    /* background soft glows */
    body::before, body::after{
      content:"";
      position:fixed;
      pointer-events:none;
      filter:blur(120px);
      opacity:0.65;
      z-index:0;
    }
    body::before{
      width:540px; height:540px; top:-180px; right:-130px;
      background:radial-gradient(circle at center, rgba(81,167,255,0.6), rgba(255,255,255,0));
    }
    body::after{
      width:560px; height:560px; bottom:-220px; left:-160px;
      background:radial-gradient(circle at center, rgba(143,219,255,0.55), rgba(255,255,255,0));
    }

    /* =========================================================================
       APP SHELL
       ========================================================================= */
    .app-shell{
  width:min(100%,480px);
  min-height:100vh;
  padding:clamp(24px,6vw,44px) clamp(18px,6vw,32px) 160px;
  position:relative;
  z-index:1;
  display:flex;
}

    .screen-stack{flex:1; display:flex; position:relative;}
    .screen{
      display:none;
      width:100%;
      position:relative;
      animation:fadeSlide var(--slow);
    }
    .screen.active{display:block;}

    @keyframes fadeSlide{
      from{opacity:0; transform:translateY(18px);}
      to{opacity:1; transform:translateY(0);}
    }

    /* Soft screen glow layer */
    .screen::before{
      content:"";
      position:absolute; inset:0; z-index:-1;
      border-radius:var(--radius-2xl);
      background:radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.15) 65%, rgba(255,255,255,0) 100%);
      opacity:0.75;
      pointer-events:none;
    }
    #screen-welcome::before{
      background:radial-gradient(120% 120% at 50% 10%, rgba(255,255,255,0.75) 0%, rgba(188,215,255,0.38) 55%, rgba(255,255,255,0) 100%);
      opacity:.9;
    }
    #screen-profile::before{background:radial-gradient(120% 120% at 0% 0%, rgba(180,209,255,0.4) 0%, rgba(255,255,255,0) 70%);}
    #screen-calculator::before{background:radial-gradient(120% 120% at 100% 0%, rgba(158,224,255,0.38) 0%, rgba(255,255,255,0) 75%);}
    #screen-history::before{background:radial-gradient(120% 120% at 0% 50%, rgba(226,236,255,0.45) 0%, rgba(255,255,255,0) 80%);}
    #screen-stats::before{background:radial-gradient(130% 130% at 50% 100%, rgba(187,226,255,0.45) 0%, rgba(255,255,255,0) 80%);}

    /* =========================================================================
       TYPO / COMMON
       ========================================================================= */
    h1{font-size:clamp(2.2rem,8vw,2.7rem); font-weight:800; letter-spacing:-.01em; text-align:center;}
    h2{font-size:1.5rem; font-weight:700;}
    p{color:var(--muted); line-height:1.6;}
    .caption{font-size:.72rem; text-transform:uppercase; letter-spacing:.18em; color:var(--muted);}

    /* =========================================================================
       HEADER BARS
       ========================================================================= */
    .screen-header{
      display:flex; align-items:center; justify-content:space-between;
      padding:18px 22px; margin-bottom:18px;
      border-radius:var(--radius-xl);
      background:var(--glass);
      backdrop-filter:blur(24px);
      border:1px solid var(--glass-border);
      box-shadow:var(--shadow-soft);
    }
    .header-icon{
      width:46px; height:46px; border-radius:18px;
      background:linear-gradient(135deg, rgba(49,115,255,0.92), rgba(120,216,255,0.65));
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 16px 32px -18px rgba(26,92,255,0.7);
    }
    .header-icon svg{width:22px; height:22px; fill:#fff;}

    /* =========================================================================
       WELCOME
       ========================================================================= */
    .welcome-hero{
      margin-top:24px;
      display:flex; flex-direction:column; align-items:center; gap:26px;
      text-align:center;
    }
    .welcome-pill{
      padding:10px 18px; border-radius:999px;
      background:rgba(255,255,255,0.65); border:1px solid rgba(255,255,255,0.6);
      color:var(--muted); font-size:.82rem;
      backdrop-filter:blur(20px);
      box-shadow:0 10px 28px -22px rgba(15,27,60,0.8);
    }
    .welcome-copy{max-width:340px; font-size:1rem;}

    /* === HERO CLOCK (replaces .hero-orb) ==================================== */
    .hero-clock{
      width:220px; height:220px; position:relative; border-radius:50%;
      display:grid; place-items:center;
      background:
        radial-gradient(circle at 50% 38%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.8) 35%, rgba(245,250,255,0.55) 60%, rgba(35,123,255,0.20) 100%);
      box-shadow:
        0 22px 60px -32px rgba(25,78,255,0.55),
        inset 0 14px 36px rgba(255,255,255,0.9),
        inset 0 -12px 28px rgba(120,180,255,0.25);
      overflow:visible;
      animation:floatClock 5s ease-in-out infinite;
      isolation:isolate;
    }
    /* dial rim */
    .hero-clock::before{
      content:"";
      position:absolute; inset:10px; border-radius:50%;
      background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 60%, rgba(240,246,255,0.8) 62%, rgba(230,238,255,0.45) 65%, rgba(255,255,255,0) 70%);
      box-shadow:
        inset 0 0 0 1px rgba(180,205,255,0.55),
        inset 0 6px 18px rgba(255,255,255,0.9),
        0 24px 54px -34px rgba(40,88,210,0.55);
      pointer-events:none;
    }
    /* subtle ground shadow */
    .hero-clock::after{
      content:"";
      position:absolute; width:70%; height:16px; bottom:-20px; left:15%;
      background:radial-gradient(ellipse at center, rgba(30,50,105,0.28), rgba(30,50,105,0) 70%);
      filter:blur(10px);
      opacity:.65;
      z-index:-1;
    }

    /* body center */
    .clock-body{
      position:relative; width:72%; height:72%; border-radius:50%;
      background:
        radial-gradient(circle at 50% 45%, rgba(255,255,255,0.95) 0%, rgba(245,250,255,0.85) 50%, rgba(200,220,255,0.60) 80%, rgba(180,210,255,0.45) 100%);
      box-shadow:
        inset 0 0 0 1px rgba(210,222,255,0.55),
        inset 0 20px 50px rgba(255,255,255,0.9);
      display:grid; place-items:center;
    }

    /* tick marks (12) */
    .clock-body::before{
      content:"";
      position:absolute; inset:10%; border-radius:50%;
      background:
        conic-gradient(from -90deg,
          rgba(103,140,225,0.35) 0.5deg, transparent 1deg,
          transparent 29deg, rgba(103,140,225,0.35) 30deg,
          transparent 31deg, transparent 59deg, rgba(103,140,225,0.35) 60deg,
          transparent 61deg, transparent 89deg, rgba(103,140,225,0.35) 90deg,
          transparent 91deg, transparent 119deg, rgba(103,140,225,0.35) 120deg,
          transparent 121deg, transparent 149deg, rgba(103,140,225,0.35) 150deg,
          transparent 151deg, transparent 179deg, rgba(103,140,225,0.35) 180deg,
          transparent 181deg, transparent 209deg, rgba(103,140,225,0.35) 210deg,
          transparent 211deg, transparent 239deg, rgba(103,140,225,0.35) 240deg,
          transparent 241deg, transparent 269deg, rgba(103,140,225,0.35) 270deg,
          transparent 271deg, transparent 299deg, rgba(103,140,225,0.35) 300deg,
          transparent 301deg, transparent 329deg, rgba(103,140,225,0.35) 330deg,
          transparent 331deg
        );
      filter:blur(.2px);
    }

    /* hands */
    .clock-hand{
      position:absolute; bottom:50%; left:50%;
      transform-origin:bottom center;
      background:linear-gradient(180deg, rgba(53,109,255,0.9), rgba(120,216,255,0.9));
      border-radius:999px;
      box-shadow:0 6px 16px -8px rgba(33,88,255,0.65);
    }
    .clock-hand.hour{ width:6px; height:34%; transform:translate(-50%, 0) rotate(0deg); animation:tickHour 720s linear infinite; }
    .clock-hand.minute{ width:4px; height:46%; transform:translate(-50%, 0) rotate(0deg); animation:tickMinute 60s linear infinite; }

    /* bells */
    .clock-bell{
      position:absolute; top:-22px; width:54px; height:28px; border-radius:999px 999px 16px 16px/999px 999px 16px 16px;
      background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(205,220,255,0.9));
      box-shadow:
        0 10px 20px -12px rgba(25,70,180,0.55),
        inset 0 4px 10px rgba(255,255,255,0.9);
    }
    .clock-bell.left{ left:28px; transform:rotate(-8deg); }
    .clock-bell.right{ right:28px; transform:rotate(8deg); }

    /* legs */
    .clock-leg{
      position:absolute; bottom:-6px; width:20px; height:8px; border-radius:12px;
      background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(210,225,255,0.9));
      box-shadow:0 8px 18px -10px rgba(25,60,140,0.5);
    }
    .clock-leg.left{ left:46px; transform:rotate(-8deg); }
    .clock-leg.right{ right:46px; transform:rotate(8deg); }

    /* motion */
    @keyframes floatClock{
      0%,100%{ transform:translateY(0) }
      50%{ transform:translateY(-12px) }
    }
    @keyframes tickMinute{ from{ transform:translate(-50%, 0) rotate(0deg); } to{ transform:translate(-50%, 0) rotate(360deg); } }
    @keyframes tickHour{ from{ transform:translate(-50%, 0) rotate(0deg); } to{ transform:translate(-50%, 0) rotate(360deg); } }

    /* =========================================================================
       CARDS / INPUTS / BUTTONS
       ========================================================================= */
    .card{
      background:var(--glass-strong);
      backdrop-filter:blur(26px);
      border-radius:var(--radius-xl);
      border:1px solid var(--glass-border);
      box-shadow:var(--shadow-soft);
      padding:24px;
    }
    .stack{display:flex; flex-direction:column; gap:18px;}

    input{
      width:100%;
      border-radius:var(--radius-md);
      border:1px solid rgba(202,213,255,0.45);
      padding:14px 18px;
      background:rgba(255,255,255,0.55);
      backdrop-filter:blur(10px);
      font-size:1rem; font-weight:500; color:var(--text);
      transition:border var(--fast), box-shadow var(--fast), transform var(--fast);
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.8);
    }
    input::placeholder{color:rgba(109,125,150,0.7); font-weight:400;}
    input:focus{ outline:none; border-color:rgba(50,120,255,0.8); box-shadow:0 0 0 4px rgba(68,143,255,0.18); transform:translateY(-1px); }

    button{
      position:relative; width:100%; border:none; border-radius:var(--radius-md);
      padding:16px 18px; font-size:1.03rem; font-weight:700; letter-spacing:.01em; color:#fff; cursor:pointer;
      background:linear-gradient(135deg, #2967ff 0%, #25cfff 100%);
      box-shadow:0 28px 60px -32px rgba(19,95,255,0.95);
      transition:transform var(--fast), box-shadow var(--fast);
      overflow:hidden;
    }
    button::after{
      content:""; position:absolute; inset:0;
      background:linear-gradient(120deg, rgba(255,255,255,0.35), rgba(255,255,255,0));
      opacity:0; transition:opacity var(--fast);
    }
    button:hover{ transform:translateY(-2px) scale(1.01); }
    button:hover::after{ opacity:1; }
    button:active{ transform:scale(0.98); }
    .btn-secondary{
      background:rgba(255,255,255,0.9);
      color:var(--blue-600);
      border:1px solid rgba(160,185,255,0.55);
      box-shadow:none;
    }

    /* =========================================================================
       RESULT BOX
       ========================================================================= */
    .result-box{
      display:none;
      border-radius:var(--radius-xl);
      padding:28px 22px; text-align:center;
      background:linear-gradient(160deg, rgba(38,107,255,0.22) 0%, rgba(255,255,255,0.78) 100%);
      border:1px solid rgba(120,174,255,0.4);
      box-shadow:0 28px 58px -34px rgba(32,83,255,0.65);
      animation:scaleUp var(--slow);
    }
    @keyframes scaleUp{ from{opacity:0; transform:translateY(16px) scale(0.98);} to{opacity:1; transform:translateY(0) scale(1);} }
    .result-box .hours{ font-size:3.2rem; font-weight:800; color:var(--blue-600); margin-bottom:8px; }

    .decision-buttons{ display:flex; gap:12px; margin-top:20px; }
    .decision-buttons button{ flex:1; box-shadow:none; }
    .decision-buttons .save{ background:linear-gradient(135deg, #1fb981 0%, #36e1a9 100%); }
    .decision-buttons .buy{ background:linear-gradient(135deg, #ff5c6a 0%, #ff7f9a 100%); }

    /* =========================================================================
       HISTORY
       ========================================================================= */
    #history-list{ display:flex; flex-direction:column; gap:16px; }
    .history-item{
      position:relative; padding:20px 22px 22px 26px; border-radius:var(--radius-md);
      background:var(--glass); backdrop-filter:blur(24px);
      border:1px solid rgba(210,222,255,0.45);
      box-shadow:0 16px 40px -32px rgba(30,50,105,0.5);
      transition:transform var(--fast), box-shadow var(--fast);
      animation:cardEnter .45s ease both;
      overflow:hidden;
    }
    .history-item::before{
      content:""; position:absolute; top:18px; left:12px; bottom:18px; width:6px; border-radius:999px;
      background:linear-gradient(180deg, rgba(53,109,255,0.8), rgba(112,200,255,0.45));
    }
    .history-item.green::before{ background:linear-gradient(180deg, rgba(32,187,130,0.9), rgba(115,236,189,0.5)); }
    .history-item.red::before{ background:linear-gradient(180deg, rgba(255,92,106,0.9), rgba(255,162,174,0.5)); }
    .history-item strong{ display:block; font-weight:700; margin-bottom:4px;}
    .history-item span{ font-weight:600; color:var(--text); }
    .history-item small{ color:var(--muted); font-size:.78rem; display:block; margin-top:6px;}
    .history-item:hover{ transform:translateY(-4px); box-shadow:0 26px 60px -34px rgba(30,54,126,0.66); }
    @keyframes cardEnter{ from{opacity:0; transform:translateY(18px);} to{opacity:1; transform:translateY(0);} }

    /* =========================================================================
       STATS
       ========================================================================= */
    .stats-grid{ display:flex; flex-direction:column; gap:20px;}
    .progress-shell{
      display:flex; flex-direction:column; align-items:center; gap:16px;
      padding:28px 24px 32px; border-radius:var(--radius-xl);
      background:var(--glass); border:1px solid rgba(210,222,255,0.45);
      box-shadow:var(--shadow-soft); backdrop-filter:blur(28px);
    }
    .progress-ring{
      --progress:0deg;
      width:168px; height:168px; border-radius:50%; position:relative;
      background:
        radial-gradient(circle at center, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.2) 58%, rgba(255,255,255,0) 65%),
        conic-gradient(from -90deg, #2b5bf7 var(--progress), rgba(235,242,255,0.6) var(--progress));
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 30px 70px -40px rgba(24,85,255,0.5);
      transition:background .6s ease;
    }
    .progress-ring::after{
      content:""; position:absolute; inset:12px; border-radius:50%; background:rgba(255,255,255,0.88); backdrop-filter:blur(16px);
    }
    #ratio{ position:relative; font-size:2.4rem; font-weight:800; color:var(--blue-600); z-index:1; }
    .pulse{ animation:pulseText .8s ease; }
    @keyframes pulseText{ 0%{transform:scale(.92); opacity:.3;} 60%{transform:scale(1.05); opacity:1;} 100%{transform:scale(1);} }

    .stats-cards{ display:flex; flex-direction:column; gap:16px; }
    .stats-card{
      border-radius:var(--radius-lg); padding:20px 22px;
      background:var(--glass-strong); border:1px solid rgba(210,222,255,0.45);
      box-shadow:0 18px 50px -34px rgba(30,60,120,0.6); backdrop-filter:blur(20px);
    }
    .stats-card strong{ font-size:1.6rem; color:var(--text); }

    /* =========================================================================
       FLOATING NAV (glass, centered, floating above bottom)
       ========================================================================= */
    nav{
      position:fixed; left:50%; bottom:36px; transform:translateX(-50%);
      width:min(100%,380px); padding:10px; border-radius:999px;
      background:rgba(255,255,255,0.30); backdrop-filter:blur(28px);
      border:1px solid rgba(255,255,255,0.6); box-shadow:var(--shadow-nav);
      display:flex; gap:10px; z-index:20;
    }
    nav button{
      flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px;
      padding:12px; border-radius:18px; background:transparent; color:var(--muted);
      font-size:.74rem; font-weight:700; letter-spacing:.01em; transition:background var(--fast), color var(--fast), transform var(--fast);
      border:none;
    }
    nav button svg{ width:22px; height:22px; fill:currentColor; transition:transform var(--fast); }
    nav button span{ font-size:.72rem; }
    nav button:hover{ transform:translateY(-2px); }
    nav button:hover svg{ transform:translateY(-1px); }
    nav button.active{
      background:linear-gradient(135deg, rgba(42,104,255,0.92), rgba(55,212,255,0.78));
      color:#fff; box-shadow:0 18px 45px -28px rgba(19,95,255,0.9);
    }
    nav button.active svg{ fill:#fff; }
    .nav-glow{
      position:absolute; inset:-18px -30px; border-radius:inherit;
      background:radial-gradient(circle at center, rgba(48,130,255,0.2), rgba(48,130,255,0));
      opacity:0; transition:opacity var(--fast); z-index:-1;
    }
    nav button.active .nav-glow{ opacity:1; }

    @media(min-width:520px){ nav{ bottom:46px; } }
  </style>
</head>
<body>
  <!-- ✅ hero-clock + nav-profile present -->
  <div id="build-badge" style="position:fixed;left:8px;top:6px;font-size:12px;color:#5d6b85;opacity:.9;z-index:50;">build: vNEXT</div>

  <div class="app-shell">
    <main class="screen-stack">

      <!-- 1. Welcome -->
      <section id="screen-welcome" class="screen active" data-theme="welcome">
        <div class="welcome-hero">
          <div class="welcome-pill">Personal finance companion</div>
          <h1>Munkaóra</h1>

          <!-- REPLACED ORB → CLOCK -->
          <div class="hero-clock" role="img" aria-label="Alarm clock">
            <div class="clock-body">
              <div class="clock-hand hour"></div>
              <div class="clock-hand minute"></div>
            </div>
            <div class="clock-bell left"></div>
            <div class="clock-bell right"></div>
            <div class="clock-leg left"></div>
            <div class="clock-leg right"></div>
          </div>

          <p class="welcome-copy">Számold ki, mennyi munkaórádba kerül egy vágyott vásárlás és érezd nagyon rosszul magad!</p>
          <div class="card" style="display:flex;justify-content:center;align-items:center;">
            <button onclick="goTo('profile'); track('start_click')">Belépés a profilodhoz</button>
          </div>
        </div>
      </section>

      <!-- 2. Profil -->
      <section id="screen-profile" class="screen" data-theme="profile">
        <header class="screen-header">
          <div>
            <span class="caption">Munkaóra</span>
            <h2>Profilod</h2>
          </div>
          <div class="header-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M12 12.75a5.25 5.25 0 1 0-5.25-5.25A5.26 5.26 0 0 0 12 12.75Zm0 2.25c-3.486 0-7.5 1.757-7.5 4.5a1.5 1.5 0 0 0 1.5 1.5h12a1.5 1.5 0 0 0 1.5-1.5c0-2.743-4.014-4.5-7.5-4.5Z"/></svg>
          </div>
        </header>
        <div class="stack">
          <div class="card stack">
            <p>Add meg az alapadataidat, hogy pontosan lássuk, mennyi időt dolgozol egy termékért.</p>
            <input id="name" placeholder="Név" />
            <input id="age" placeholder="Életkor" type="number" />
            <input id="city" placeholder="Település" />
            <input id="income" placeholder="Havi nettó jövedelem (Ft)" type="number" />
            <input id="hours" placeholder="Heti munkaóra" type="number" />
            <button onclick="saveProfile()">Mentés és továbblépés</button>
          </div>
        </div>
      </section>

      <!-- 3. Kalkulátor -->
      <section id="screen-calculator" class="screen" data-theme="calculator">
        <header class="screen-header">
          <div>
            <span class="caption">Munkaóra</span>
            <h2>Kalkulátor</h2>
          </div>
          <div class="header-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M6 2.75h12A3.25 3.25 0 0 1 21.25 6v12A3.25 3.25 0 0 1 18 21.25H6A3.25 3.25 0 0 1 2.75 18V6A3.25 3.25 0 0 1 6 2.75Zm.5 4a.75.75 0 0 0 0 1.5h2a.75.75 0 0 0 0-1.5h-2Zm0 4a.75.75 0 0 0 0 1.5h10a.75.75 0 0 0 0-1.5h-10Zm0 4a.75.75 0 0 0 0 1.5h10a.75.75 0 0 0 0-1.5h-10Z"/></svg>
          </div>
        </header>
        <div class="stack">
          <div class="card">
            <div class="stack">
              <p>Írd be a terméket és az árát, és azonnal megmutatjuk, mennyi munkaidődbe kerülne.</p>
              <input id="product" placeholder="Terméknév" />
              <input id="price" placeholder="Ár (Ft)" type="number" />
              <button onclick="calculate()">Számolás</button>

              <div id="result-box" class="result-box">
                <div class="hours" id="hoursResult">0</div>
                <p>munkaórádba kerülne</p>
                <div class="decision-buttons">
                  <button class="save" onclick="saveDecision('megsporolom')">Megspórolom</button>
                  <button class="buy" onclick="saveDecision('megveszem')">Megveszem</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 4. Előzmények -->
      <section id="screen-history" class="screen" data-theme="history">
        <header class="screen-header">
          <div>
            <span class="caption">Munkaóra</span>
            <h2>Előzmények</h2>
          </div>
          <div class="header-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M12 3.75A8.25 8.25 0 1 0 20.25 12a.75.75 0 0 1 1.5 0 9.75 9.75 0 1 1-3.31-7.324l1.155-1.154a.75.75 0 1 1 1.06 1.06l-2.5 2.5a.75.75 0 0 1-1.28-.53V4.5a.75.75 0 0 1 1.5 0v1.134A8.23 8.23 0 0 0 12 3.75Zm.75 4.5v3.44l2.845 1.705a.75.75 0 0 1-.76 1.29l-3.25-1.95A.75.75 0 0 1 11.25 12V8.25a.75.75 0 0 1 1.5 0Z"/></svg>
          </div>
        </header>
        <div class="stack">
          <div id="history-list"></div>
        </div>
      </section>

      <!-- 5. Statisztikák -->
      <section id="screen-stats" class="screen" data-theme="stats">
        <header class="screen-header">
          <div>
            <span class="caption">Munkaóra</span>
            <h2>Statisztikák</h2>
          </div>
          <div class="header-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M5.75 4A1.75 1.75 0 0 1 7.5 2.25h1A1.75 1.75 0 0 1 10.25 4v15.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2Zm5.5 5A1.75 1.75 0 0 1 13 7.25h1A1.75 1.75 0 0 1 15.75 9v10.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2Zm5.5-5A1.75 1.75 0 0 1 18.5 4v15.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2V4a1.75 1.75 0 0 1 1.75-1.75h1Z"/></svg>
          </div>
        </header>
        <div class="stack">
          <div class="stats-grid">
            <div class="progress-shell">
              <div class="progress-ring" id="ratioCircle">
                <span id="ratio">0%</span>
              </div>
              <p>Spórolási arány</p>
            </div>
            <div class="stats-cards">
              <div class="stats-card">
                <p><strong id="savedHours">0</strong> óra megspórolva</p>
              </div>
              <div class="stats-card">
                <p><strong id="spentHours">0</strong> óra elköltve</p>
              </div>
            </div>
          </div>
          <div class="card" style="display:flex;justify-content:center;align-items:center;">
            <button onclick="goTo('calculator')">Új kalkuláció</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Lebegő, üveges nav (középen, emelve) -->
  <nav>
    <button id="nav-calculator" onclick="goTo('calculator')" aria-label="Kalkulátor">
      <span class="nav-glow" aria-hidden="true"></span>
      <svg viewBox="0 0 24 24"><path d="M6.75 3A2.75 2.75 0 0 0 4 5.75v12.5A2.75 2.75 0 0 0 6.75 21h10.5A2.75 2.75 0 0 0 20 18.25V5.75A2.75 2.75 0 0 0 17.25 3Zm.75 3.5h9a.75.75 0 0 1 0 1.5h-9a.75.75 0 0 1 0-1.5Zm0 4h9a.75.75 0 0 1 0 1.5h-9a.75.75 0 0 1 0-1.5Zm0 4h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1 0-1.5Z"/></svg>
      <span>Kalkulátor</span>
    </button>
    <button id="nav-history" onclick="goTo('history')" aria-label="Előzmények">
      <span class="nav-glow" aria-hidden="true"></span>
      <svg viewBox="0 0 24 24"><path d="M12 2.75A9.25 9.25 0 1 0 21.25 12a.75.75 0 0 1 1.5 0 10.75 10.75 0 1 1-3.694-8.076l1.288-1.288a.75.75 0 0 1 1.06 1.06l-2.75 2.75a.75.75 0 0 1-1.28-.53V4.5a.75.75 0 0 1 1.5 0v.792A9.23 9.23 0 0 0 12 2.75Zm.75 5.5v3.69l3.095 1.855a.75.75 0 0 1-.75 1.29l-3.5-2.1A.75.75 0 0 1 11.25 12V8.25a.75.75 0 0 1 1.5 0Z"/></svg>
      <span>Előzmények</span>
    </button>
    <button id="nav-stats" onclick="goTo('stats')" aria-label="Statisztikák">
      <span class="nav-glow" aria-hidden="true"></span>
      <svg viewBox="0 0 24 24"><path d="M6.75 4A1.75 1.75 0 0 1 8.5 2.25h1A1.75 1.75 0 0 1 11.25 4v15.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2Zm5.5 5A1.75 1.75 0 0 1 14 7.25h1A1.75 1.75 0 0 1 16.75 9v10.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2Zm5.5-5A1.75 1.75 0 0 1 19.5 4v15.75a2 2 0 0 1-2 2h-.75a2 2 0 0 1-2-2V4a1.75 1.75 0 0 1 1.75-1.75h1Z"/></svg>
      <span>Statisztikák</span>
    </button>
    <button id="nav-profile" onclick="goTo('profile')" aria-label="Profil">
      <span class="nav-glow" aria-hidden="true"></span>
      <svg viewBox="0 0 24 24"><path d="M12 12.75a5.25 5.25 0 1 0-5.25-5.25A5.26 5.26 0 0 0 12 12.75Zm0 2.25c-3.486 0-7.5 1.757-7.5 4.5a1.5 1.5 0 0 0 1.5 1.5h12a1.5 1.5 0 0 0 1.5-1.5c0-2.743-4.014-4.5-7.5-4.5Z"/></svg>
      <span>Profil</span>
    </button>
  </nav>

  <script>
    /* ======================================================
       GA event helper
       ====================================================== */
    function track(name, params = {}) {
      if (window.gtag) window.gtag('event', name, params);
    }

    /* ======================================================
       Navigation
       ====================================================== */
    function goTo(screen) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(`screen-${screen}`).classList.add('active');

      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      const nb = document.getElementById(`nav-${screen}`);
      if (nb) nb.classList.add('active');

      track('view_' + screen);

      if (screen === 'history') loadHistory();
      if (screen === 'stats') loadStats();
    }

    /* ======================================================
       Storage
       ====================================================== */
    const STORE_KEY = 'munkaora_data';
    function loadData(){
      try{ return JSON.parse(localStorage.getItem(STORE_KEY)) || { profile:{}, history:[] }; }
      catch(e){ return { profile:{}, history:[] }; }
    }
    function saveData(data){ localStorage.setItem(STORE_KEY, JSON.stringify(data)); }

    /* ======================================================
       Profile
       ====================================================== */
    function saveProfile(){
      const data = loadData();
      data.profile = {
        name: document.getElementById('name').value,
        age: +document.getElementById('age').value,
        city: document.getElementById('city').value,
        income: +document.getElementById('income').value,
        hoursPerWeek: +document.getElementById('hours').value
      };
      saveData(data);
      track('profile_saved');
      goTo('calculator');
    }

    /* ======================================================
       Calculator
       ====================================================== */
    let currentProduct = null;
    let currentPrice = 0;
    let currentHours = 0;

    function calculate(){
      const data = loadData();
      const p = data.profile;

      if(!p.income || !p.hoursPerWeek){
        alert('Előbb add meg a profilod adatait!');
        goTo('profile');
        return;
      }

      const product = document.getElementById('product').value.trim();
      const price = +document.getElementById('price').value;

      if(!product || !price){
        alert('Add meg a termék nevét és árát!');
        return;
      }

      const hourly = p.income / (p.hoursPerWeek * 4);
      const hours = (price / hourly).toFixed(1);

      document.getElementById('result-box').style.display = 'block';
      document.getElementById('hoursResult').innerText = hours;

      currentProduct = product;
      currentPrice = price;
      currentHours = hours;

      track('calculation_done', { product, price });
    }

    /* ======================================================
       Decision
       ====================================================== */
    function saveDecision(type){
      if(!currentProduct){ alert('Előbb számoljunk!'); return; }

      const data = loadData();
      data.history.push({
        id: Date.now(),
        product: currentProduct,
        price: currentPrice,
        hours: currentHours,
        decision: type,
        ts: new Date().toISOString()
      });
      saveData(data);

      track('decision_click', { decision: type, product: currentProduct, price: currentPrice });

      document.getElementById('result-box').style.display = 'none';
      document.getElementById('product').value = '';
      document.getElementById('price').value = '';

      goTo('history');
    }

    /* ======================================================
       History
       ====================================================== */
    function loadHistory(){
      const list = document.getElementById('history-list');
      list.innerHTML = '';
      const data = loadData();

      if(data.history.length === 0){
        list.innerHTML = '<div class="card" style="text-align:center;"><p>Még nincs adatod.</p><button class="btn-secondary" onclick="goTo(\'calculator\')">Indíts kalkulációt</button></div>';
        track('history_empty_view');
        return;
      }

      [...data.history].reverse().forEach(item=>{
        const el = document.createElement('div');
        el.className = 'history-item ' + (item.decision === 'megsporolom' ? 'green' : 'red');
        el.innerHTML =
          '<strong>' + escapeHtml(item.product) + '</strong>' +
          '<span>' + Number(item.price).toLocaleString('hu-HU') + ' Ft</span><br>' +
          '<small>' + item.hours + ' óra • ' + new Date(item.ts).toLocaleDateString('hu-HU') + '</small>';
        list.appendChild(el);
      });
      track('history_loaded', { count: data.history.length });
    }

    /* ======================================================
       Stats
       ====================================================== */
    function loadStats(){
      const data = loadData();
      const saved = data.history.filter(i => i.decision === 'megsporolom');
      const spent = data.history.filter(i => i.decision === 'megveszem');

      const total = data.history.length;
      const ratio = total ? Math.round((saved.length / total) * 100) : 0;

      const ratioEl = document.getElementById('ratio');
      ratioEl.innerText = ratio + '%';
      ratioEl.classList.remove('pulse'); void ratioEl.offsetWidth; ratioEl.classList.add('pulse');

      const ratioCircle = document.getElementById('ratioCircle');
      if(ratioCircle){ ratioCircle.style.setProperty('--progress', (ratio * 3.6) + 'deg'); }

      const savedHours = saved.reduce((sum,i)=> sum + Number(i.hours), 0);
      const spentHours = spent.reduce((sum,i)=> sum + Number(i.hours), 0);

      document.getElementById('savedHours').innerText = savedHours.toFixed(1);
      document.getElementById('spentHours').innerText = spentHours.toFixed(1);

      track('stats_loaded', { total, ratio, savedHours, spentHours });
    }

    /* ======================================================
       Init + helpers
       ====================================================== */
    (function init(){
      const d = loadData();
      if(d.profile){
        document.getElementById('name').value = d.profile.name || '';
        document.getElementById('age').value = d.profile.age || '';
        document.getElementById('city').value = d.profile.city || '';
        document.getElementById('income').value = d.profile.income || '';
        document.getElementById('hours').value = d.profile.hoursPerWeek || '';
      }
    })();

    function escapeHtml(str){
      return String(str)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'",'&#039;');
    }
  </script>
</body>
</html>


