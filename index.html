<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Munka√≥ra</title>

  <!-- GOOGLE ANALYTICS HELY -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXX');
  </script>
  -->

  <style>
    :root {
      --blue: #007aff;
      --blue-dark: #005fe0;
      --green: #22c55e;
      --red: #ef4444;
      --gray: #6b7280;
      --bg: #f7f9fb;
      --white: #ffffff;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: #111;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
    }

    h1, h2 {
      margin: 0 0 1rem 0;
      font-weight: 600;
    }

    h1 {
      font-size: clamp(1.8rem, 5vw, 2.2rem);
      text-align: center;
    }

    h2 {
      font-size: 1.4rem;
    }

    p {
      margin: 0.25rem 0 1rem 0;
      line-height: 1.4;
      color: var(--gray);
    }

    input {
      width: 100%;
      padding: 0.9rem 1rem;
      margin-bottom: 0.8rem;
      border: 1px solid #d1d5db;
      border-radius: 10px;
      font-size: 1rem;
      background: var(--white);
      transition: border 0.2s;
    }

    input:focus {
      outline: none;
      border-color: var(--blue);
    }

    button {
      appearance: none;
      border: none;
      border-radius: 12px;
      padding: 1rem;
      font-size: 1.05rem;
      font-weight: 500;
      color: var(--white);
      background: var(--blue);
      width: 100%;
      transition: background 0.25s, transform 0.1s;
    }

    button:active {
      transform: scale(0.98);
    }

    button:hover {
      background: var(--blue-dark);
    }

    .screen {
      display: none;
      width: 100%;
      max-width: 420px;
      min-height: 100vh;
      padding: 1.5rem 1.25rem 5.5rem;
      background: var(--bg);
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }

    .active {
      display: block;
    }

    .float-icon {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: var(--blue);
      box-shadow: 0 15px 30px rgba(0, 122, 255, 0.25);
      margin: 60px auto;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%,100% {transform: translateY(0);}
      50% {transform: translateY(-10px);}
    }

    nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--white);
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 64px;
      z-index: 10;
    }

    nav button {
      background: none;
      color: var(--gray);
      font-size: 1.4rem;
      width: auto;
      padding: 0.5rem 1rem;
      border-radius: 8px;
    }

    nav button.active {
      color: var(--blue);
      background: #e0ecff;
    }

    .result-box {
      background: #e8f0fe;
      border: 2px solid var(--blue);
      border-radius: 16px;
      padding: 2rem 1rem;
      text-align: center;
      margin: 1.5rem 0;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    .result-box .hours {
      font-size: 3rem;
      font-weight: 700;
      color: var(--blue);
    }

    .decision-buttons {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      margin-top: 1.25rem;
    }

    .decision-buttons button {
      width: 50%;
    }

    .decision-buttons button:first-child { background: var(--green); }
    .decision-buttons button:last-child { background: var(--red); }

    .history-item {
      background: var(--white);
      border-left: 6px solid;
      border-radius: 10px;
      margin-bottom: 10px;
      padding: 14px 18px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .history-item.green { border-color: var(--green); }
    .history-item.red { border-color: var(--red); }
    .history-item strong { font-weight: 600; }
    .history-item small { color: var(--gray); font-size: 0.8rem; }

    .stats-box {
      background: var(--white);
      border-radius: 16px;
      padding: 1.5rem;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      margin-bottom: 1rem;
    }

    .stats-box .big {
      font-size: 2.5rem;
      color: var(--blue);
      font-weight: 600;
    }

    .cta {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
    }

  </style>
</head>
<body>

  <!-- WELCOME -->
  <div id="screen-welcome" class="screen active">
    <h1>Munka√≥ra</h1>
    <p style="text-align:center;">L√°ssuk, h√°ny √≥r√°t dolgozol egy-egy v√°s√°rl√°s√©rt</p>
    <div class="float-icon"></div>
    <div class="cta">
      <button onclick="goTo('profile'); track('start_click')">Kezdj√ºk</button>
    </div>
  </div>

  <!-- PROFILE -->
  <div id="screen-profile" class="screen">
    <h2>Profilod</h2>
    <p>Add meg egyszer az alapadataidat</p>
    <input id="name" placeholder="N√©v" />
    <input id="age" placeholder="√âletkor" type="number" />
    <input id="city" placeholder="Telep√ºl√©s" />
    <input id="income" placeholder="Havi nett√≥ j√∂vedelem (Ft)" type="number" />
    <input id="hours" placeholder="Heti munka√≥ra" type="number" />
    <button onclick="saveProfile()">Ment√©s √©s tov√°bbl√©p√©s</button>
  </div>

  <!-- CALCULATOR -->
  <div id="screen-calculator" class="screen">
    <h2>Kalkul√°tor</h2>
    <p>√çrd be a term√©ket √©s az √°r√°t</p>
    <input id="product" placeholder="Term√©kn√©v" />
    <input id="price" placeholder="√År (Ft)" type="number" />
    <button onclick="calculate()">N√©zz√ºk</button>

    <div id="result-box" class="result-box" style="display:none;">
      <div class="hours" id="hoursResult">0</div>
      <p>munka√≥r√°dba ker√ºlne</p>
      <div class="decision-buttons">
        <button onclick="saveDecision('megsporolom')">Megsp√≥rolom</button>
        <button onclick="saveDecision('megveszem')">Megveszem</button>
      </div>
    </div>
  </div>

  <!-- HISTORY -->
  <div id="screen-history" class="screen">
    <h2>El≈ëzm√©nyek</h2>
    <div id="history-list"></div>
  </div>

  <!-- STATS -->
  <div id="screen-stats" class="screen">
    <h2>Statisztik√°k</h2>
    <div class="stats-box">
      <div class="big" id="ratio">0%</div>
      <p>Sp√≥rol√°si ar√°ny</p>
    </div>
    <div class="stats-box">
      <p><strong id="savedHours">0</strong> √≥ra megsp√≥rolva</p>
      <p><strong id="spentHours">0</strong> √≥ra elk√∂ltve</p>
    </div>
    <div class="cta">
      <button onclick="goTo('calculator')">√öj kalkul√°ci√≥</button>
    </div>
  </div>

  <!-- NAV -->
  <nav>
    <button id="nav-calculator" class="active" onclick="goTo('calculator')">üßÆ</button>
    <button id="nav-history" onclick="goTo('history')">üìú</button>
    <button id="nav-stats" onclick="goTo('stats')">üìä</button>
  </nav>

  <script>
    // -------- ANALYTICS TRACKING --------
    function track(name, params={}) {
      if (window.gtag) window.gtag('event', name, params);
    }

    // -------- NAVIGATION --------
    function goTo(screen) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(`screen-${screen}`).classList.add('active');
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      const navBtn = document.getElementById(`nav-${screen}`);
      if (navBtn) navBtn.classList.add('active');
      track('view_'+screen);
      if (screen === 'history') loadHistory();
      if (screen === 'stats') loadStats();
    }

    // -------- STORAGE --------
    const storeKey = "munkaora_data";
    function loadData() {
      return JSON.parse(localStorage.getItem(storeKey) || '{"profile":{},"history":[]}');
    }
    function saveData(data) {
      localStorage.setItem(storeKey, JSON.stringify(data));
    }

    // -------- PROFILE --------
    function saveProfile() {
      const data = loadData();
      data.profile = {
        name: document.getElementById('name').value,
        age: +document.getElementById('age').value,
        city: document.getElementById('city').value,
        income: +document.getElementById('income').value,
        hoursPerWeek: +document.getElementById('hours').value
      };
      saveData(data);
      track('profile_saved');
      goTo('calculator');
    }

    // -------- CALCULATOR --------
    let currentProduct = null;
    let currentPrice = 0;
    let currentHours = 0;

    function calculate() {
      const data = loadData();
      const p = data.profile;
      if (!p.income || !p.hoursPerWeek) {
        alert('El≈ëbb add meg a profilod adatait!');
        goTo('profile');
        return;
      }
      const product = document.getElementById('product').value.trim();
      const price = +document.getElementById('price').value;
      if (!product || !price) return alert('Add meg a term√©k nev√©t √©s √°r√°t!');
      const hourly = p.income / (p.hoursPerWeek * 4);
      const hours = (price / hourly).toFixed(1);
      document.getElementById('result-box').style.display = 'block';
      document.getElementById('hoursResult').innerText = hours;
      currentProduct = product;
      currentPrice = price;
      currentHours = hours;
      track('calculation_done');
    }

    function saveDecision(type) {
      const data = loadData();
      data.history.push({
        id: Date.now(),
        product: currentProduct,
        price: currentPrice,
        hours: currentHours,
        decision: type,
        ts: new Date().toISOString()
      });
      saveData(data);
      track('decision_click', { decision: type });
      document.getElementById('result-box').style.display = 'none';
      document.getElementById('product').value = '';
      document.getElementById('price').value = '';
      goTo('history');
    }

    // -------- HISTORY --------
    function loadHistory() {
      const list = document.getElementById('history-list');
      list.innerHTML = '';
      const data = loadData();
      if (data.history.length === 0) {
        list.innerHTML = '<p style="color:var(--gray);text-align:center;">M√©g nincs adatod.</p>';
        return;
      }
      [...data.history].reverse().forEach(item => {
        const div = document.createElement('div');
        div.className = 'history-item ' + (item.decision === 'megsporolom' ? 'green' : 'red');
        div.innerHTML = `<strong>${item.product}</strong><br>${item.price.toLocaleString()} Ft<br><small>${item.hours} √≥ra ‚Ä¢ ${new Date(item.ts).toLocaleDateString()}</small>`;
        list.appendChild(div);
      });
    }

    // -------- STATS --------
    function loadStats() {
      const data = loadData();
      const saved = data.history.filter(i => i.decision === 'megsporolom');
      const spent = data.history.filter(i => i.decision === 'megveszem');
      const ratio = data.history.length ? Math.round((saved.length / data.history.length) * 100) : 0;
      document.getElementById('ratio').innerText = ratio + '%';
      const savedHours = saved.reduce((sum, i) => sum + +i.hours, 0);
      const spentHours = spent.reduce((sum, i) => sum + +i.hours, 0);
      document.getElementById('savedHours').innerText = savedHours.toFixed(1);
      document.getElementById('spentHours').innerText = spentHours.toFixed(1);
    }

    // INIT
    (function init() {
      const data = loadData();
      if (data.profile.name) {
        document.getElementById('name').value = data.profile.name;
        document.getElementById('age').value = data.profile.age || '';
        document.getElementById('city').value = data.profile.city || '';
        document.getElementById('income').value = data.profile.income || '';
        document.getElementById('hours').value = data.profile.hoursPerWeek || '';
      }
    })();
  </script>
</body>
</html>
